<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Command line - Darwin-py docs</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../css/theme.css" />
  <link rel="stylesheet" href="../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "Command line";
    var mkdocs_page_input_path = "commandline.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/sh.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/bash.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/python.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> Darwin-py docs</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="..">Darwin SDK and CLI</a>
                    </li>
                </ul>
                <ul class="current">
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">Command line</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#authentication">Authentication</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#datasets">Datasets</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#creating-a-dataset">Creating a dataset</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#list-remote-datasets">List remote datasets</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#list-remote-files">List remote files</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#set-file-status">Set file status</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#list-local-datasets">List local datasets</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#uploading-imagesvideos">Uploading images/videos</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#releases">Releases</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#create-a-new-release">Create a new release</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#list-all-releases">List all releases</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#download-a-release">Download a release</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#path-to-dataset">Path to dataset</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#delete-a-remote-dataset">Delete a remote dataset</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#import-annotations">Import annotations</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#convert-annotations">Convert annotations</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#formats">Formats</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#darwin-darwin-import">Darwin darwin import</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#pascalvoc-pascal_voc-import-export">PascalVoc pascal_voc (import &amp; export)</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#dataloop-dataloop-import-export">Dataloop dataloop (import &amp; export)</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#csv-tags-csv_tags-import">CSV Tags csv_tags (import)</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#csv-tags-video-csv_tags_video">CSV Tags Video (csv_tags_video)</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#coco-coco-import-export">COCO coco (import &amp; export)</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#cvat-cvat-export">CVAT cvat (export)</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#instance-mask-instance-export">Instance Mask instance (export)</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#semenatic-mask-semantic-mask-export">Semenatic Mask semantic-mask (export)</a>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    </ul>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../library/">Library</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../torch/">PyTorch bindings</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">Darwin-py docs</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
    
    <li>Command line</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="command-line">Command line</h1>
<h2 id="authentication">Authentication</h2>
<p>To perform remote operations on Darwin you first need to authenticate.
Authentication requires a <a href="https://darwin.v7labs.com/?settings=api-keys">team-specific API-key</a>.<br />
If you do not already have a Darwin account, you can <a href="https://www.v7labs.com/contact">contact us</a> and we can set one up for you.</p>
<p>To start the authentication process:</p>
<pre><code class="sh">$ darwin authenticate
API key: ***********
Make example-team the default team? [y/N] y
Datasets directory [~/.darwin/datasets]: 
Authentication succeeded.
</code></pre>

<p>You will be then prompted to enter your API-key, whether you want to set the corresponding team as 
default and finally the desired location on the local file system for the datasets of that team.
This process will create a configuration file at <code>~/.darwin/config.yaml</code>.
This file will be updated with future authentications for different teams.</p>
<p><strong>Note</strong> that the API key rights selected when requesting the key determine which of the following commands are allowed. If the key has insufficient permissions for an action an error will be shown <code>Insufficient permissions</code> or <code>Invalid API key</code>. </p>
<h2 id="datasets">Datasets</h2>
<p>A central part of Darwin are the datasets. They contain images/videos, annotation classes, instructions and annotations. In this documentation we will refer to a dataset as <em>remote</em> when it's hosted on Darwin, and <em>local</em> when a copy has been made locally. </p>
<p>A dataset can either be referred by its name directly, but this can lead to ambiguity when authenticating with multiple teams (hence the use of default team), or by <code>team-name/dataset-name</code>. Team and Dataset names are slugified:</p>
<ul>
<li>lower case</li>
<li>spaces is replaced with dash</li>
<li>special characters are stripped</li>
</ul>
<p>Datasets can generate a release by freezing all annotations made up to a certain point in time, this release will have a unique name using this format <code>team-name/dataset-name:version-name</code> See (Releases)[###Releases]</p>
<h3 id="creating-a-dataset">Creating a dataset</h3>
<p>Creates a new remote dataset (hosted on Darwin):</p>
<pre><code>$ darwin dataset create test
Dataset 'mydataset' (example-team/mydataset) has been created.
Access at https://darwin.v7labs.com/datasets/579
</code></pre>

<h3 id="list-remote-datasets">List remote datasets</h3>
<p>Lists all datasets for the default team</p>
<pre><code>$ darwin dataset remote
NAME                       IMAGES     PROGRESS
example-team/mydataset     112025        73.0%
example-team/fg-removal      3000        42.0%
</code></pre>

<p>Use the <code>-t</code> flag to specify a different team</p>
<pre><code>$ darwin dataset remote -t other-team
NAME                       IMAGES     PROGRESS
other-team/ct-scans           450        100.0%
</code></pre>

<h3 id="list-remote-files">List remote files</h3>
<p>Lists all files in a remote dataset, can optional by filtered by file status and/or foldername. 
Allowed statuses: <code>new</code>, <code>annotate</code>, <code>review</code>, <code>complete</code>, <code>archived</code></p>
<pre><code>$ darwin dataset files example-team/mydataset 
test1.png complete
test2.png complete
test3.png annotate
</code></pre>

<pre><code>$ darwin dataset files example-team/mydataset --path outdoors
test1.png complete
</code></pre>

<pre><code>$ darwin dataset files example-team/mydataset --status complete
test1.png complete
test2.png complete
</code></pre>

<p>Add <code>--only-filenames</code> to only list the filename.</p>
<h3 id="set-file-status">Set file status</h3>
<p>Allows to set the status of a file in a dataset. Allowed statuses are: <code>archived</code> and <code>restore-archived</code> (More will be added soon).</p>
<pre><code>$ darwin dataset set-file-status example-team/my-new-dataset archived 00000010.jpg
</code></pre>

<p>This can be used in conjunction with <code>darwin dataset files</code>, for example:</p>
<pre><code>$ darwin dataset set-file-status example-team/my-new-dataset archived $(darwin dataset files example-team/my-new-dataset --status error --only-filenames)
</code></pre>

<h3 id="list-local-datasets">List local datasets</h3>
<p>Local datasets are datasets that have been downloaded, </p>
<pre><code>$ darwin dataset local
NAME                                                   IMAGES     SYNC_DATE         SIZE
example-team/mydataset                                    999        May 25     150.2 MB
other-team/ct-scans                                       450        May 20     500.1 MB
</code></pre>

<h3 id="uploading-imagesvideos">Uploading images/videos</h3>
<p>For images and videos</p>
<pre><code>$ darwin dataset push my-team/test /path/to/folder/with/images
100%|████████████████████████| 2/2 [00:01&lt;00:00,  1.27it/s] 
</code></pre>

<p>Specifying framerate for videos</p>
<pre><code>$ darwin dataset push my-team/test --fps 2 my_video.mp4
100%|████████████████████████| 1/1 [00:01&lt;00:00,  1.27it/s] 
</code></pre>

<p>The <code>-e/--exclude</code> argument allows to indicate file extension/s to be ignored from the data_dir. 
e.g.: <code>-e .jpg</code></p>
<p>For videos, the frame rate extraction rate can be specified by adding <code>--fps &lt;frame_rate&gt;</code>
To use the intrinsic frame rate of the video either leave out the fps flag or use <code>--fps native</code></p>
<p>Supported extensions:</p>
<ul>
<li>Video files: [<code>.mp4</code>, <code>.bpm</code>, <code>.mov</code> formats].</li>
<li>Image files [<code>.jpg</code>, <code>.jpeg</code>, <code>.png</code> formats].</li>
</ul>
<p>There is also an optional <code>--path</code> flag to move the uploaded files into the specified directory.</p>
<pre><code>$ darwin dataset push my-team/test --path animals/cats cat1.png cat2.png
100%|████████████████████████| 1/2 [00:01&lt;00:00,  2.42it/s] 
</code></pre>

<h3 id="releases">Releases</h3>
<p>To download data from a dataset, a release first needs to be created. Several releases can be kept locally at the same time, images are shared between the releases to reduce disk usage. </p>
<pre><code>/dataset_directory      # by default ~/.darwin/datasets
   /team-name
       /dataset-name
            /images     # shared between all releases
                1.png
                2.png
                3.png
            /releases
                /latest # symlink to the latest release (v3)
                /v3
                    1.json
                    2.json
                    3.json
                /v2
                    1.json
                    2.json
                /v1
                    1.json

</code></pre>

<h4 id="create-a-new-release">Create a new release</h4>
<pre><code>$ darwin dataset export test 0.1
Dataset test successfully exported to example-team/test:0.1
</code></pre>

<h4 id="list-all-releases">List all releases</h4>
<pre><code>$ darwin dataset releases example-team/my-new-dataset
NAME                                    IMAGES     CLASSES                   EXPORT_DATE
example-team/my-new-dataset:0.4             23           9     2020-05-11 14:48:25+00:00
example-team/my-new-dataset:0.2              1           8     2020-04-28 23:50:56+00:00
example-team/my-new-dataset:0.1             22           7     2020-04-17 09:57:22+00:00
</code></pre>

<h4 id="download-a-release">Download a release</h4>
<pre><code>$ darwin dataset pull example-team/my-new-dataset:0.1
100%|███████████████████████████| 100/100 [00:20&lt;00:00,  7.18it/s]
Dataset example-team/my-new-dataset:0.4 downloaded at ~/.darwin/datasets/example-team
</code></pre>

<p>If you dataset contains folders and you want to mirror the folder structure locally add <code>--folders</code></p>
<p>Note that if this was the latest release for this dataset, then this release can also be referred to it via <code>:latest</code> for local operations.
Only datasets exported in the Darwin (JSON) format are downloadable via darwin-py. </p>
<h3 id="path-to-dataset">Path to dataset</h3>
<p>A convenient command to find a dataset on the local filesystem (if downloaded)</p>
<pre><code>$ darwin dataset path example-team/my-new-dataset
/Users/me/.darwin/datasets/example-team/my-new-dataset
</code></pre>

<h3 id="delete-a-remote-dataset">Delete a remote dataset</h3>
<p>This goes without saying, but be careful when deleting datasets. Their data will be cleared from Darwin's servers and unrecoverable after a couple of days. </p>
<pre><code>$ darwin dataset remove test
About to delete example-team/test on darwin.
Do you want to continue? [y/N] y
</code></pre>

<h3 id="import-annotations">Import annotations</h3>
<p>If you want to bootstrap your dataset by importing already existing annotations, first make sure that all the images are already uploaded. Then ensure that the annotations are in one of the following formats [Darwin, PascalVoc, COCO, CSV Tags, CSV Video Tag, Dataloop]. </p>
<pre><code>$ darwin dataset import example-team/test pascal_voc sample_voc.xml
Fetching remote file list...
Fetching remote class list...
Retrieving local annotations ...
1 annotation file(s) found.
1 file(s) are missing from the dataset
        imports/sample_voc.xml: '12.png'
Do you want to continue? [y/N] y
0 classes are missing remotely.
</code></pre>

<p>There are few things going on here:</p>
<ul>
<li>first darwin-py tries to match each file in the import against files in the dataset, if that fails it will warn us and allow the operation to be cancelled. </li>
<li>then annotation classes are matched (exact name + type). If they are missing remotely darwin-py will prompt asking if it's allowed to create them.</li>
<li>finally all the annotations are uploaded. </li>
</ul>
<p><strong>Note</strong> In the current version, old annotations are deleted before the imports are applied. </p>
<h3 id="convert-annotations">Convert annotations</h3>
<pre><code>$ darwin dataset convert example-team/my-new-dataset:0.1 coco -o output_directory
</code></pre>

<p>This converts the downloaded annotations from the darwin format to an external format. Currently supported: [COCO, CVAT, Pascal VOC]</p>
<p><strong>Note</strong> Some annotations types are not valid for some formats, when that happens the annotation is simply dropped. </p>
<h3 id="formats">Formats</h3>
<h4 id="darwin-darwin-import">Darwin <code>darwin</code> import</h4>
<p>This is the standard format used when exporting annotations from darwin. </p>
<h4 id="pascalvoc-pascal_voc-import-export">PascalVoc <code>pascal_voc</code> (import &amp; export)</h4>
<p>An xml format specifying bounding boxes. </p>
<h4 id="dataloop-dataloop-import-export">Dataloop <code>dataloop</code> (import &amp; export)</h4>
<h4 id="csv-tags-csv_tags-import">CSV Tags <code>csv_tags</code> (import)</h4>
<p>A csv file with one line per file, first column is the file name and the remaning columns are tags.</p>
<p>Example:</p>
<pre><code class="csv">a.png,outdoors,sunny,blurry
b.png,indoors
</code></pre>

<h4 id="csv-tags-video-csv_tags_video">CSV Tags Video (<code>csv_tags_video</code>)</h4>
<p>A csv file with one line per tag, the first column is the video filename, followed by tag name, start frame and end frame</p>
<p>Example:</p>
<pre><code class="csv">1.mp4,car,20,34
1.mp4,bird,5,25
2.mp4,bird,0,40
</code></pre>

<h4 id="coco-coco-import-export">COCO <code>coco</code> (import &amp; export)</h4>
<p>A json file containing annotations for multiple images. See <a href="https://cocodataset.org/#format-data">https://cocodataset.org/#format-data</a> for the format definition. </p>
<h4 id="cvat-cvat-export">CVAT <code>cvat</code> (export)</h4>
<h4 id="instance-mask-instance-export">Instance Mask <code>instance</code> (export)</h4>
<p>Creates one mask per object per image. </p>
<h4 id="semenatic-mask-semantic-mask-export">Semenatic Mask <code>semantic-mask</code> (export)</h4>
<p>Creates one mask per image, different colors per class. 
A <code>class_mapping.csv</code> is also created containing a mapping between <code>class_name</code> and <code>class_color</code></p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../library/" class="btn btn-neutral float-right" title="Library">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href=".." class="btn btn-neutral" title="Darwin SDK and CLI"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href=".." style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../library/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
